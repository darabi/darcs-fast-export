= darcs backend for fast data importers
Miklos Vajna <vmiklos-at-frugalware-dot-org>

== Purpose and Features

darcs-fast-export is a tool to dump a http://darcs.net/[darcs]
repository in a format understood by "fast-importers" such as
http://git.or.cz/[git]
http://www.kernel.org/pub/software/scm/git/docs/git-fast-import.html[fast-import].
It exhibits the following _features:_

Fast::
	darcs-fast-export provides a fast darcs backend for fast-import.
	Converting a huge repo (26094 patches, repo size 210M) took about 10
	hours.

Independent::
	Ideally it should work with any fast importer, but actually it has been
	tested with git fast-import, bzr fast-import and hg fastimport. (These
	are the three fast-import implementations available ATM.)
	+
	hg fastimport needs two patches. While they are not in the upstream, you
	can get it from my repository using
+
----
$ hg clone static-http://frugalware.org/~vmiklos/hg/hg-fastimport
----

Formats::
	It supports the 'darcs-2', 'hashed', and 'old-fashioned-inventory' darcs
	repository formats.

Incremental conversions::
	It supports the usual `--export-marks` / `--import-marks` switches to
	allow incremental conversion.

Author mappings::
	Supports `--authors-file` option like Git's SVN adaptor, for DARCS
	repositories that originated in CVS or SVN.

== Usage

darcs-fast-export expects one argument, the path to the source darcs
repository. It will print the git fast-import format on standard output
(stdout).

There are some command line options, which will be explained if you
type:
----
$ darcs-fast-export --help
----

=== Example

Assuming that `test/` is a darcs repo, you could do this:
----
$ mkdir test.git
$ git --bare init
$ darcs-fast-export test |(cd test.git; git fast-import)
----

To verify the results, you could compare them:
----
$ git clone -q test.git test.git.nonbare
$ diff --exclude .git -Naur test.git.nonbare test/_darcs/pristine
$ rm -rf test.git.nonbare
----

If you get no output, then the conversion was successful.

For more examples (especially for bzr and hg), see the `t/` directory.

== Download

Using git:
----
$ git clone git://vmiklos.hu/darcs-fast-export
----

== Status

darcs-fast-export has been tested with the following versions:

Darcs version:
----
$ darcs --version
2.1.0 (release)
----

Git version:
----
$ git --version
git version 1.6.0.2
----

Bzr versions:
----
$ bzr version
Bazaar (bzr) 1.9
$ ls /usr/lib/python*/site-packages/fastimport*
/usr/lib/python2.5/site-packages/fastimport-0.6.0final0-py2.5.egg-info
----

Mercurial (Hg) version:
----
$ hg version
Mercurial Distributed SCM (version 1.0.2)
----

== Alternatives

- http://repo.or.cz/w/darcs2git.git[darcs2git] tries to find conflict
  resolutions (to map them to merge commits), which is ideally an even
  better conversion than the official darcs1 -> darcs2 converter, but it's
  much slower because of this. It does not support the darcs2 format
  and/or incremental conversions, either.

- http://progetti.arstecnica.it/tailor[tailor] is a nice any2any VCS
  converter, but the end result can easily differ to the original repo
  because tailor replays all the changesets itself, while
  darcs-fast-export just leaves this task to darcs.

- http://github.com/freshtonic/undarcs/tree/master[undarcs] claims to be
  fast, but it produces incorrect result in case the repo contains
  conflicts.

== Thanks

- Jason Dagit for helping me with darcs2 issues
- Shawn O. Pearce and Johannes Schindelin for writing `git-fast-import`
  / `git-fast-export`
- Ian Clatworthy for writing bzr fast-import
- Paul Crowley for writing hg fast-import
- Matthias Andree for assorted improvements
